## last modify hc.song@sk.com  2012/12/05

## Remote script download && execution
UserParameter=user.scriptrun[*],/app/zabbix/scripts/scriptrun.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"

UserParameter=user.dmesg[*],/app/zabbix/scripts/checkdmesg.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"

# UserParameter=user.crond-zupdate[*],/app/zabbix/scripts/zabbix_cronup.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"

UserParameter=user.garbage-disposal[*],/app/zabbix/scripts/garbage-disposal.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"
UserParameter=user.searchlog[*],/app/zabbix/scripts/check_searchlog.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"
UserParameter=user.applist[*],/app/zabbix/scripts/applist.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"
UserParameter=user.isvip[*],/app/zabbix/scripts/isvip.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"
UserParameter=user.checkrootpw[*],/app/zabbix/scripts/checkrootpw.py "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"
UserParameter=user.expireuser[*],/app/zabbix/scripts/check_expireuser.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"
UserParameter=user.wheeladd[*],/app/zabbix/scripts/wheel_useradd.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"

UserParameter=user.check[*],/app/zabbix/scripts/check_user.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"

# Mysql Montoring
UserParameter=mysql.secroot,/app/zabbix/scripts/mysql_secroot.sh
UserParameter=mysql.ping,/mysql/local/mysql/bin/mysqladmin -udbmon -pmaxrpdlwl\!0  ping|grep -c alive
UserParameter=mysql.uptime,/mysql/local/mysql/bin/mysqladmin -udbmon -pmaxrpdlwl\!0 status|cut -f2 -d":"|cut -f2 -d" "
UserParameter=mysql.threads,/mysql/local/mysql/bin/mysqladmin -udbmon -pmaxrpdlwl\!0 status|cut -f3 -d":"|cut -f2 -d" "
UserParameter=mysql.questions,/mysql/local/mysql/bin/mysqladmin -udbmon -pmaxrpdlwl\!0 status|cut -f4 -d":"|cut -f2 -d" "
UserParameter=mysql.slowqueries,/mysql/local/mysql/bin/mysqladmin -udbmon -pmaxrpdlwl\!0 status|cut -f5 -d":"|cut -f2 -d" "
UserParameter=mysql.qps,/mysql/local/mysql/bin/mysqladmin -udbmon -pmaxrpdlwl\!0 status|cut -f9 -d":"|cut -f2 -d" "
UserParameter=mysql.version,/mysql/local/mysql/bin/mysql -V
UserParameter=mysql.replication[*],/app/zabbix/scripts/check_mysql_replica.sh $1

# Flexible parameter to grab global variables. On the frontend side, use keys like mysql.status[Com_insert].
# # Key syntax is mysql.status[variable].
UserParameter=mysql.status[*],echo "show global status where Variable_name='$1';" | /mysql/local/mysql/bin/mysql -N -udbmon -pmaxrpdlwl\!0 | cut -f2

# Oracle
UserParameter=oracle.arch[*],/app/zabbix/scripts/check_oracle_arch.sh "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"
#
# Flexible parameter to determine database or table size. On the frontend side, use keys like mysql.size[zabbix,history,data].
# Key syntax is mysql.size[<database>,<table>,<type>].
# Database may be a database name or "all". Default is "all".
# Table may be a table name or "all". Default is "all".
# Type may be "data", "index", "free" or "both". Both is a sum of data and index. Default is "both".
# Database is mandatory if a table is specified. Type may be specified always.
# Returns value in bytes.
# 'sum' on data_length or index_length alone needed when we are getting this information for whole database instead of a single table
UserParameter=mysql.size[*],echo "select sum($(case "$3" in both|"") echo "data_length+index_length";; data|index) echo "$3_length";; free) echo "data_free";; esac)) from information_schema.tables$([[ "$1" = "all" || ! "$1" ]] || echo " where table_schema='$1'")$([[ "$2" = "all" || ! "$2" ]] || echo "and table_name='$2'");" | /mysql/local/mysql/bin/mysql -N -udbmon -pmaxrpdlwl\!0

# apache
UserParameter=apache[*],/app/zabbix/scripts/zapache "$1" "$2" "$3" "$4" "$5" "$6" "$7" "$8" "$9" "$10"

# Memcached stat
UserParameter=memcached.bytes[*],[ -z $1 ] && PORT=11211 || PORT=$1; rm -f /tmp/memcached.${PORT}.stat && (echo stats; sleep 0.1) | telnet localhost $PORT 2>1 > /tmp/memcached.${PORT}.stat ; [ -f /tmp/memcached.${PORT}.stat ] && RET=`cat /tmp/memcached.${PORT}.stat | awk '/STAT bytes / {print $NF}'` && [ -z $RET ] && echo 0 || echo $RET

UserParameter=memcached.bytes_read[*],[ -z $1 ] && PORT=11211 || PORT=$1; rm -f /tmp/memcached.${PORT}.stat && (echo stats; sleep 0.1) | telnet localhost $PORT 2>1 > /tmp/memcached.${PORT}.stat ; [ -f /tmp/memcached.${PORT}.stat ] && RET=`cat /tmp/memcached.${PORT}.stat | awk '/STAT bytes_read / {print $NF}'` && [ -z $RET ] && echo 0 || echo $RET

# UserParameter=memcached[*],(echo stats; sleep 0.1) | telnet localhost 11211 2>&1 | awk '/STAT $1 / {print $NF}'
UserParameter=memcached[*],[ -z $2 ] && PORT=11211 || PORT=$2; [ -f /tmp/memcached.${PORT}.stat ] && RET=`cat /tmp/memcached.${PORT}.stat | awk '/STAT $1 / {print $NF}'` && [ -z $RET ] && echo 0 || echo $RET 

# Redis
UserParameter=redis.discovery,/app/zabbix/scripts/check_redis.sh localhost list_key_space_db
UserParameter=redis[*],/app/zabbix/scripts/check_redis.sh $1 $2 $3

# Swift
UserParameter=swift.total,/usr/bin/swift-recon -d | grep used | awk '{print $NF}'
UserParameter=swift.free,/usr/bin/swift-recon -d | grep free | awk '{print $(NF-2)}'
UserParameter=swift.used,/usr/bin/swift-recon -d | grep used | awk '{print $(NF-2)}'

# SSL
UserParameter=ssl_check.py[*],/app/zabbix/scripts/ssl_check.py $1 $2

# traceroute
UserParameter=net.tracert[*],/app/zabbix/scripts/check_tracert $1 $2 $3
